export type Glyph = string[];

export interface FontDef {
  width: number;
  height: number;
  glyphs: Record<string, Glyph>;
  spacing?: number;
}

// ── Sans font (5x7) ──────────────────────────────────────────────
const SANS: Record<string, Glyph> = {
  A: [".###.", "#...#", "#...#", "#####", "#...#", "#...#", "#...#"],
  B: ["####.", "#...#", "#...#", "####.", "#...#", "#...#", "####."],
  C: [".####", "#....", "#....", "#....", "#....", "#....", ".####"],
  D: ["####.", "#...#", "#...#", "#...#", "#...#", "#...#", "####."],
  E: ["#####", "#....", "#....", "####.", "#....", "#....", "#####"],
  F: ["#####", "#....", "#....", "####.", "#....", "#....", "#...."],
  G: [".####", "#....", "#....", "#.###", "#...#", "#...#", ".###."],
  H: ["#...#", "#...#", "#...#", "#####", "#...#", "#...#", "#...#"],
  I: ["#####", "..#..", "..#..", "..#..", "..#..", "..#..", "#####"],
  J: ["..###", "...#.", "...#.", "...#.", "...#.", "#..#.", ".##.."],
  K: ["#...#", "#..#.", "#.#..", "##...", "#.#..", "#..#.", "#...#"],
  L: ["#....", "#....", "#....", "#....", "#....", "#....", "#####"],
  M: ["#...#", "##.##", "#.#.#", "#.#.#", "#...#", "#...#", "#...#"],
  N: ["#...#", "##..#", "#.#.#", "#..##", "#...#", "#...#", "#...#"],
  O: [".###.", "#...#", "#...#", "#...#", "#...#", "#...#", ".###."],
  P: ["####.", "#...#", "#...#", "####.", "#....", "#....", "#...."],
  Q: [".###.", "#...#", "#...#", "#...#", "#.#.#", "#..#.", ".##.#"],
  R: ["####.", "#...#", "#...#", "####.", "#.#..", "#..#.", "#...#"],
  S: [".####", "#....", "#....", ".###.", "....#", "....#", "####."],
  T: ["#####", "..#..", "..#..", "..#..", "..#..", "..#..", "..#.."],
  U: ["#...#", "#...#", "#...#", "#...#", "#...#", "#...#", ".###."],
  V: ["#...#", "#...#", "#...#", "#...#", ".#.#.", ".#.#.", "..#.."],
  W: ["#...#", "#...#", "#...#", "#.#.#", "#.#.#", "##.##", "#...#"],
  X: ["#...#", "#...#", ".#.#.", "..#..", ".#.#.", "#...#", "#...#"],
  Y: ["#...#", "#...#", ".#.#.", "..#..", "..#..", "..#..", "..#.."],
  Z: ["#####", "....#", "...#.", "..#..", ".#...", "#....", "#####"],
  " ": [".....", ".....", ".....", ".....", ".....", ".....", "....."],
  "0": [".###.", "#...#", "#..##", "#.#.#", "##..#", "#...#", ".###."],
  "1": ["..#..", ".##..", "..#..", "..#..", "..#..", "..#..", ".###."],
  "2": [".###.", "#...#", "....#", "..##.", ".#...", "#....", "#####"],
  "3": [".###.", "#...#", "....#", "..##.", "....#", "#...#", ".###."],
  "4": ["...#.", "..##.", ".#.#.", "#..#.", "#####", "...#.", "...#."],
  "5": ["#####", "#....", "####.", "....#", "....#", "#...#", ".###."],
  "6": [".###.", "#....", "#....", "####.", "#...#", "#...#", ".###."],
  "7": ["#####", "....#", "...#.", "..#..", ".#...", ".#...", ".#..."],
  "8": [".###.", "#...#", "#...#", ".###.", "#...#", "#...#", ".###."],
  "9": [".###.", "#...#", "#...#", ".####", "....#", "....#", ".###."],
  "!": ["..#..", "..#..", "..#..", "..#..", "..#..", ".....", "..#.."],
  "?": [".###.", "#...#", "....#", "..##.", "..#..", ".....", "..#.."],
  ".": [".....", ".....", ".....", ".....", ".....", ".....", "..#.."],
  ",": [".....", ".....", ".....", ".....", ".....", "..#..", ".#..."],
  ":": [".....", "..#..", ".....", ".....", ".....", "..#..", "....."],
  ";": [".....", "..#..", ".....", ".....", ".....", "..#..", ".#..."],
  "-": [".....", ".....", ".....", "#####", ".....", ".....", "....."],
  "+": [".....", "..#..", "..#..", "#####", "..#..", "..#..", "....."],
  "=": [".....", ".....", "#####", ".....", "#####", ".....", "....."],
  "/": ["....#", "....#", "...#.", "..#..", ".#...", "#....", "#...."],
  "(": ["..#..", ".#...", "#....", "#....", "#....", ".#...", "..#.."],
  ")": ["..#..", "...#.", "....#", "....#", "....#", "...#.", "..#.."],
  "'": ["..#..", "..#..", ".....", ".....", ".....", ".....", "....."],
  '"': [".#.#.", ".#.#.", ".....", ".....", ".....", ".....", "....."],
  "#": [".#.#.", "#####", ".#.#.", ".#.#.", ".#.#.", "#####", ".#.#."],
  "@": [".###.", "#...#", "#.###", "#.#.#", "#.##.", "#....", ".####"],
  "&": [".##..", "#..#.", ".##..", ".#...", "#.#.#", "#..#.", ".##.#"],
  "*": [".....", ".#.#.", "..#..", "#####", "..#..", ".#.#.", "....."],
  "_": [".....", ".....", ".....", ".....", ".....", ".....", "#####"],
  "<": ["...#.", "..#..", ".#...", "#....", ".#...", "..#..", "...#."],
  ">": [".#...", "..#..", "...#.", "....#", "...#.", "..#..", ".#..."],
  "[": [".###.", ".#...", ".#...", ".#...", ".#...", ".#...", ".###."],
  "]": [".###.", "...#.", "...#.", "...#.", "...#.", "...#.", ".###."],
  "%": ["##..#", "##.#.", "..#..", "..#..", "..#..", ".#.##", "#..##"],
  "^": ["..#..", ".#.#.", "#...#", ".....", ".....", ".....", "....."],
  "~": [".....", ".....", ".#...", "#.#.#", "...#.", ".....", "....."],
  "$": ["..#..", ".####", "#.#..", ".###.", "..#.#", "####.", "..#.."],
};

// ── Serif font (5x7) ── swung/rounded serif style ──────────────
const SERIF: Record<string, Glyph> = { ...SANS };
SERIF.A = ["..#..", ".#.#.", "#...#", "#####", "#...#", "#...#", "#...#"];
SERIF.B = [".##..", "#..#.", "#..#.", "#.##.", "#...#", "#...#", ".###."];
SERIF.C = [".###.", "#....", "#....", "#....", "#....", "#....", ".###."];
SERIF.D = ["###..", "#..#.", "#...#", "#...#", "#...#", "#..#.", ".##.."];
SERIF.E = [".####", "#....", "#....", ".###.", "#....", "#....", ".####"];
SERIF.F = [".####", "#....", "#....", ".###.", "#....", "#....", ".#..."];
SERIF.G = [".###.", "#....", "#....", "#.###", "#...#", ".#..#", "..##."];
SERIF.H = ["#...#", "#...#", "#...#", "#####", "#...#", "#...#", "#...#"];
SERIF.I = [".###.", "..#..", "..#..", "..#..", "..#..", "..#..", ".###."];
SERIF.J = ["..###", "...#.", "...#.", "...#.", "...#.", ".#.#.", "..#.."];
SERIF.K = ["#...#", "#..#.", "#.#..", "##...", "#.#..", "#..#.", "#...#"];
SERIF.L = ["#....", "#....", "#....", "#....", "#....", ".#...", ".####"];
SERIF.M = ["#...#", "##.##", "#.#.#", "#.#.#", "#...#", "#...#", "#...#"];
SERIF.N = ["#...#", "##..#", "#.#.#", "#..##", "#...#", "#...#", "#...#"];
SERIF.O = [".###.", "#...#", "#...#", "#...#", "#...#", "#...#", ".###."];
SERIF.P = [".###.", "#...#", "#...#", ".###.", "#....", "#....", ".#..."];
SERIF.R = [".###.", "#...#", "#...#", ".###.", "#.#..", "#..#.", "#...#"];
SERIF.S = [".####", "#....", ".#...", "..#..", "...#.", "....#", "####."];
SERIF.T = ["#####", "..#..", "..#..", "..#..", "..#..", "..#..", ".###."];
SERIF.U = ["#...#", "#...#", "#...#", "#...#", "#...#", ".#.#.", "..#.."];
SERIF.X = ["#...#", ".#.#.", "..#..", "..#..", "..#..", ".#.#.", "#...#"];
SERIF.Y = ["#...#", "#...#", ".#.#.", "..#..", "..#..", "..#..", ".###."];

// ── Slim font (5x7) ──────────────────────────────────────────────
const SLIM: Record<string, Glyph> = {
  A: ["..#..", ".#.#.", "#...#", "#...#", "#####", "#...#", "#...#"],
  B: ["###..", "#..#.", "#..#.", "###..", "#..#.", "#..#.", "###.."],
  C: [".###.", "#....", "#....", "#....", "#....", "#....", ".###."],
  D: ["###..", "#..#.", "#...#", "#...#", "#...#", "#..#.", "###.."],
  E: ["#####", "#....", "#....", "###..", "#....", "#....", "#####"],
  F: ["#####", "#....", "#....", "###..", "#....", "#....", "#...."],
  G: [".###.", "#....", "#....", "#..##", "#...#", "#...#", ".###."],
  H: ["#...#", "#...#", "#...#", "#####", "#...#", "#...#", "#...#"],
  I: [".###.", "..#..", "..#..", "..#..", "..#..", "..#..", ".###."],
  J: ["..###", "...#.", "...#.", "...#.", "...#.", "#..#.", ".##.."],
  K: ["#..#.", "#.#..", "##...", "##...", "#.#..", "#..#.", "#...#"],
  L: ["#....", "#....", "#....", "#....", "#....", "#....", "#####"],
  M: ["#...#", "##.##", "#.#.#", "#...#", "#...#", "#...#", "#...#"],
  N: ["#...#", "##..#", "#.#.#", "#..##", "#...#", "#...#", "#...#"],
  O: [".###.", "#...#", "#...#", "#...#", "#...#", "#...#", ".###."],
  P: ["####.", "#...#", "#...#", "####.", "#....", "#....", "#...."],
  Q: [".###.", "#...#", "#...#", "#...#", "#.#.#", "#..#.", ".##.#"],
  R: ["####.", "#...#", "#...#", "####.", "#.#..", "#..#.", "#...#"],
  S: [".###.", "#....", "#....", ".###.", "....#", "....#", ".###."],
  T: ["#####", "..#..", "..#..", "..#..", "..#..", "..#..", "..#.."],
  U: ["#...#", "#...#", "#...#", "#...#", "#...#", "#...#", ".###."],
  V: ["#...#", "#...#", "#...#", ".#.#.", ".#.#.", "..#..", "..#.."],
  W: ["#...#", "#...#", "#...#", "#.#.#", "#.#.#", ".#.#.", ".#.#."],
  X: ["#...#", ".#.#.", "..#..", "..#..", "..#..", ".#.#.", "#...#"],
  Y: ["#...#", ".#.#.", "..#..", "..#..", "..#..", "..#..", "..#.."],
  Z: ["#####", "....#", "...#.", "..#..", ".#...", "#....", "#####"],
};

// Slim shares digits and punctuation with sans
for (const k of Object.keys(SANS)) {
  if (!(k in SLIM)) SLIM[k] = SANS[k];
}

// ── Lowercase: map to uppercase ──────────────────────────────────
function addLowercase(g: Record<string, Glyph>) {
  for (let c = 97; c <= 122; c++) {
    const lo = String.fromCharCode(c);
    const up = String.fromCharCode(c - 32);
    if (!g[lo] && g[up]) g[lo] = g[up];
  }
}
addLowercase(SANS);
addLowercase(SERIF);
addLowercase(SLIM);

// ── Narrow font (3x7) ───────────────────────────────────────────
const NARROW: Record<string, Glyph> = {
  A: [".#.", "###", "#.#", "###", "#.#", "#.#", "#.#"],
  B: ["##.", "#.#", "#.#", "##.", "#.#", "#.#", "##."],
  C: [".##", "#..", "#..", "#..", "#..", "#..", ".##"],
  D: ["##.", "#.#", "#.#", "#.#", "#.#", "#.#", "##."],
  E: ["###", "#..", "#..", "##.", "#..", "#..", "###"],
  F: ["###", "#..", "#..", "##.", "#..", "#..", "#.."],
  G: [".##", "#..", "#..", "#.#", "#.#", "#.#", ".#."],
  H: ["#.#", "#.#", "#.#", "###", "#.#", "#.#", "#.#"],
  I: ["###", ".#.", ".#.", ".#.", ".#.", ".#.", "###"],
  J: [".##", "..#", "..#", "..#", "..#", "#.#", ".#."],
  K: ["#.#", "#.#", "##.", "##.", "#.#", "#.#", "#.#"],
  L: ["#..", "#..", "#..", "#..", "#..", "#..", "###"],
  M: ["#.#", "###", "###", "#.#", "#.#", "#.#", "#.#"],
  N: ["#.#", "###", "###", "#.#", "#.#", "#.#", "#.#"],
  O: [".#.", "#.#", "#.#", "#.#", "#.#", "#.#", ".#."],
  P: ["##.", "#.#", "#.#", "##.", "#..", "#..", "#.."],
  Q: [".#.", "#.#", "#.#", "#.#", "#.#", ".#.", "..#"],
  R: ["##.", "#.#", "#.#", "##.", "#.#", "#.#", "#.#"],
  S: [".##", "#..", "#..", ".#.", "..#", "..#", "##."],
  T: ["###", ".#.", ".#.", ".#.", ".#.", ".#.", ".#."],
  U: ["#.#", "#.#", "#.#", "#.#", "#.#", "#.#", ".#."],
  V: ["#.#", "#.#", "#.#", "#.#", "#.#", ".#.", ".#."],
  W: ["#.#", "#.#", "#.#", "#.#", "###", "###", "#.#"],
  X: ["#.#", "#.#", ".#.", ".#.", ".#.", "#.#", "#.#"],
  Y: ["#.#", "#.#", ".#.", ".#.", ".#.", ".#.", ".#."],
  Z: ["###", "..#", "..#", ".#.", "#..", "#..", "###"],
  " ": ["...", "...", "...", "...", "...", "...", "..."],
  "0": [".#.", "#.#", "#.#", "#.#", "#.#", "#.#", ".#."],
  "1": [".#.", "##.", ".#.", ".#.", ".#.", ".#.", "###"],
  "2": [".#.", "#.#", "..#", ".#.", "#..", "#..", "###"],
  "3": ["##.", "..#", "..#", ".#.", "..#", "..#", "##."],
  "4": ["#.#", "#.#", "#.#", "###", "..#", "..#", "..#"],
  "5": ["###", "#..", "#..", "##.", "..#", "..#", "##."],
  "6": [".##", "#..", "#..", "##.", "#.#", "#.#", ".#."],
  "7": ["###", "..#", "..#", ".#.", ".#.", ".#.", ".#."],
  "8": [".#.", "#.#", "#.#", ".#.", "#.#", "#.#", ".#."],
  "9": [".#.", "#.#", "#.#", ".##", "..#", "..#", "##."],
  "!": [".#.", ".#.", ".#.", ".#.", ".#.", "...", ".#."],
  "?": [".#.", "#.#", "..#", ".#.", ".#.", "...", ".#."],
  ".": ["...", "...", "...", "...", "...", "...", ".#."],
  ",": ["...", "...", "...", "...", "...", ".#.", "#.."],
  ":": ["...", ".#.", "...", "...", "...", ".#.", "..."],
  "-": ["...", "...", "...", "###", "...", "...", "..."],
  "+": ["...", ".#.", ".#.", "###", ".#.", ".#.", "..."],
  "/": ["..#", "..#", ".#.", ".#.", ".#.", "#..", "#.."],
  "'": [".#.", ".#.", "...", "...", "...", "...", "..."],
};
addLowercase(NARROW);

// ── Block font (7x9) ── chunky 2px stroke with proper lowercase ──
// Rows 0-1: ascender zone, 2-6: x-height body, 7-8: descender zone
// Uppercase spans rows 0-6, lowercase x-height spans rows 2-6
const BLOCK_UC: Record<string, Glyph> = {
  A: ["#######", "##...##", "##...##", "#######", "##...##", "##...##", "##...##"],
  B: ["######.", "##...##", "##...##", "######.", "##...##", "##...##", "######."],
  C: ["#######", "##.....", "##.....", "##.....", "##.....", "##.....", "#######"],
  D: ["######.", "##...##", "##...##", "##...##", "##...##", "##...##", "######."],
  E: ["#######", "##.....", "##.....", "#####..", "##.....", "##.....", "#######"],
  F: ["#######", "##.....", "##.....", "#####..", "##.....", "##.....", "##....."],
  G: ["#######", "##.....", "##.....", "##..###", "##...##", "##...##", "#######"],
  H: ["##...##", "##...##", "##...##", "#######", "##...##", "##...##", "##...##"],
  I: ["#######", "..###..", "..###..", "..###..", "..###..", "..###..", "#######"],
  J: ["#######", "....##.", "....##.", "....##.", "....##.", "##..##.", "######."],
  K: ["##...##", "##..##.", "##.##..", "####...", "##.##..", "##..##.", "##...##"],
  L: ["##.....", "##.....", "##.....", "##.....", "##.....", "##.....", "#######"],
  M: ["##...##", "###.###", "##.#.##", "##.#.##", "##...##", "##...##", "##...##"],
  N: ["##...##", "###..##", "###..##", "##.#.##", "##..###", "##..###", "##...##"],
  O: ["#######", "##...##", "##...##", "##...##", "##...##", "##...##", "#######"],
  P: ["######.", "##...##", "##...##", "######.", "##.....", "##.....", "##....."],
  Q: ["#######", "##...##", "##...##", "##...##", "##.#.##", "##..##.", "#####.#"],
  R: ["######.", "##...##", "##...##", "######.", "##.##..", "##..##.", "##...##"],
  S: ["#######", "##.....", "##.....", "#######", ".....##", ".....##", "#######"],
  T: ["#######", "..###..", "..###..", "..###..", "..###..", "..###..", "..###.."],
  U: ["##...##", "##...##", "##...##", "##...##", "##...##", "##...##", "#######"],
  V: ["##...##", "##...##", "##...##", "##...##", ".##.##.", ".##.##.", "..###.."],
  W: ["##...##", "##...##", "##...##", "##.#.##", "##.#.##", "###.###", "##...##"],
  X: ["##...##", "##...##", ".##.##.", "..###..", ".##.##.", "##...##", "##...##"],
  Y: ["##...##", "##...##", ".##.##.", "..###..", "..###..", "..###..", "..###.."],
  Z: ["#######", "....##.", "...##..", "..##...", ".##....", "##.....", "#######"],
};

const BLOCK: Record<string, Glyph> = {};
// Pad uppercase to 9 rows (add 2 empty rows at bottom for descender zone)
for (const [char, rows] of Object.entries(BLOCK_UC)) {
  BLOCK[char] = [...rows, ".......", "......."];
}

// Lowercase with proper ascenders/descenders
// x-height body: rows 2-6 | ascenders: rows 0-1 | descenders: rows 7-8
BLOCK.a = [".......", ".......", "#######", ".....##", "#######", "##...##", "#######", ".......", "......."];
BLOCK.b = ["##.....", "##.....", "######.", "##...##", "##...##", "##...##", "######.", ".......", "......."];
BLOCK.c = [".......", ".......", "#######", "##.....", "##.....", "##.....", "#######", ".......", "......."];
BLOCK.d = [".....##", ".....##", "#######", "##...##", "##...##", "##...##", "#######", ".......", "......."];
BLOCK.e = [".......", ".......", "#######", "##...##", "#######", "##.....", "#######", ".......", "......."];
BLOCK.f = ["..#####", "..##...", "..##...", "#######", "..##...", "..##...", "..##...", ".......", "......."];
BLOCK.g = [".......", ".......", "#######", "##...##", "##...##", "##...##", "#######", ".....##", "#######"];
BLOCK.h = ["##.....", "##.....", "######.", "##...##", "##...##", "##...##", "##...##", ".......", "......."];
BLOCK.i = ["..###..", ".......", ".####..", "..###..", "..###..", "..###..", ".#####.", ".......", "......."];
BLOCK.j = ["...###.", ".......", "..####.", "...###.", "...###.", "...###.", "...###.", "##.###.", "######."];
BLOCK.k = ["##.....", "##.....", "##..##.", "##.##..", "####...", "##.##..", "##..##.", ".......", "......."];
BLOCK.l = [".####..", "..###..", "..###..", "..###..", "..###..", "..###..", ".#####.", ".......", "......."];
BLOCK.m = [".......", ".......", "###.##.", "##.#.##", "##.#.##", "##...##", "##...##", ".......", "......."];
BLOCK.n = [".......", ".......", "######.", "##...##", "##...##", "##...##", "##...##", ".......", "......."];
BLOCK.o = [".......", ".......", "#######", "##...##", "##...##", "##...##", "#######", ".......", "......."];
BLOCK.p = [".......", ".......", "######.", "##...##", "##...##", "##...##", "######.", "##.....", "##....."];
BLOCK.q = [".......", ".......", ".######", "##...##", "##...##", "##...##", ".######", ".....##", ".....##"];
BLOCK.r = [".......", ".......", "##.####", "###....", "##.....", "##.....", "##.....", ".......", "......."];
BLOCK.s = [".......", ".......", "#######", "##.....", "#######", ".....##", "#######", ".......", "......."];
BLOCK.t = ["..##...", "..##...", "#######", "..##...", "..##...", "..##...", "..#####", ".......", "......."];
BLOCK.u = [".......", ".......", "##...##", "##...##", "##...##", "##...##", "#######", ".......", "......."];
BLOCK.v = [".......", ".......", "##...##", "##...##", "##...##", ".##.##.", "..###..", ".......", "......."];
BLOCK.w = [".......", ".......", "##...##", "##...##", "##.#.##", "##.#.##", ".##.##.", ".......", "......."];
BLOCK.x = [".......", ".......", "##...##", ".##.##.", "..###..", ".##.##.", "##...##", ".......", "......."];
BLOCK.y = [".......", ".......", "##...##", "##...##", "##...##", "#######", ".....##", ".....##", "#######"];
BLOCK.z = [".......", ".......", "#######", "....##.", "..###..", ".##....", "#######", ".......", "......."];

// Digits & punctuation (padded to 9 rows)
BLOCK[" "] = [".......", ".......", ".......", ".......", ".......", ".......", ".......", ".......", "......."];
BLOCK["0"] = ["#######", "##..###", "##.#.##", "##.#.##", "##.#.##", "###..##", "#######", ".......", "......."];
BLOCK["1"] = ["..###..", ".####..", "..###..", "..###..", "..###..", "..###..", "#######", ".......", "......."];
BLOCK["2"] = ["#######", "##...##", ".....##", "..####.", ".##....", "##.....", "#######", ".......", "......."];
BLOCK["3"] = ["#######", "##...##", ".....##", "#######", ".....##", "##...##", "#######", ".......", "......."];
BLOCK["4"] = ["....##.", "...###.", "..#.##.", ".#..##.", "#######", "....##.", "....##.", ".......", "......."];
BLOCK["5"] = ["#######", "##.....", "######.", ".....##", ".....##", "##...##", "#######", ".......", "......."];
BLOCK["6"] = ["#######", "##.....", "##.....", "######.", "##...##", "##...##", "#######", ".......", "......."];
BLOCK["7"] = ["#######", ".....##", "....##.", "...##..", "..##...", "..##...", "..##...", ".......", "......."];
BLOCK["8"] = ["#######", "##...##", "##...##", "#######", "##...##", "##...##", "#######", ".......", "......."];
BLOCK["9"] = ["#######", "##...##", "##...##", "#######", ".....##", ".....##", "#######", ".......", "......."];
BLOCK["!"] = ["..###..", "..###..", "..###..", "..###..", "..###..", ".......", "..###..", ".......", "......."];
BLOCK["?"] = [".#####.", "##...##", ".....##", "..####.", "..###..", ".......", "..###..", ".......", "......."];
BLOCK["."] = [".......", ".......", ".......", ".......", ".......", ".......", "..###..", ".......", "......."];
BLOCK[","] = [".......", ".......", ".......", ".......", ".......", "..###..", ".##....", ".......", "......."];
BLOCK[":"] = [".......", ".......", "..###..", ".......", ".......", "..###..", ".......", ".......", "......."];
BLOCK["-"] = [".......", ".......", ".......", "#######", ".......", ".......", ".......", ".......", "......."];
BLOCK["+"] = [".......", "..###..", "..###..", "#######", "..###..", "..###..", ".......", ".......", "......."];
BLOCK["/"] = [".....##", "....##.", "...##..", "..##...", ".##....", "##.....", "##.....", ".......", "......."];
BLOCK["'"] = ["..###..", "..###..", ".......", ".......", ".......", ".......", ".......", ".......", "......."];
BLOCK["_"] = [".......", ".......", ".......", ".......", ".......", ".......", "#######", ".......", "......."];

// ── Bold font (6x7) ── programmatically thickened sans ──────────
function bolden(glyphs: Record<string, Glyph>): Record<string, Glyph> {
  const result: Record<string, Glyph> = {};
  for (const [char, rows] of Object.entries(glyphs)) {
    result[char] = rows.map((row) => {
      const out: string[] = [];
      for (let i = 0; i < row.length; i++) {
        out.push(row[i]);
      }
      out.push("."); // extend width by 1
      // Thicken: if a pixel is on, also turn on the one to its right
      for (let i = row.length; i >= 0; i--) {
        if (out[i] === "#" && i + 1 < out.length) {
          out[i + 1] = "#";
        }
      }
      return out.join("");
    });
  }
  return result;
}
const BOLD = bolden(SANS);
addLowercase(BOLD);

// ── Font registry ────────────────────────────────────────────────
const FONTS: Record<string, FontDef> = {
  sans: { width: 5, height: 7, glyphs: SANS },
  serif: { width: 5, height: 7, glyphs: SERIF },
  slim: { width: 5, height: 7, glyphs: SLIM },
  bold: { width: 6, height: 7, glyphs: BOLD },
  narrow: { width: 3, height: 7, glyphs: NARROW },
  block: { width: 7, height: 9, glyphs: BLOCK, spacing: 2 },
};

export function getFont(name: string): FontDef {
  return FONTS[name] || FONTS.sans;
}

export function getGlyph(font: FontDef, char: string): Glyph {
  return font.glyphs[char] || font.glyphs["?"] || Array(font.height).fill(".".repeat(font.width));
}
